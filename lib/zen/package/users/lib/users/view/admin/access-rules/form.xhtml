#{
  form_for(
    @access_rule, :method => :post, :action => @form_save_url, :id => :access_rule_form
  ) do |f|
    
    users        = {}
    groups       = {}
    packages     = {}
    rule_applies = ''
    
    if !@access_rule.user_id.nil?
      rule_applies = 'div_user_id'
    else
      rule_applies = 'div_user_group_id'
    end
    
    Users::Model::User.select(:id, :name).each do |user|
      users[user.id.to_s] = user.name
    end
    
    Zen::Package::Registered.each do |name, ext|
      name           = name.to_s
      packages[name] = name
    end
    
    Users::Model::UserGroup.select(:id, :name).each do |group|
      groups[group.id.to_s] = group.name
    end
    
    # ---------------------
    
    f.input_hidden(:id, @access_rule.id)
    f.input_hidden(:csrf_token, get_csrf_token)
    
    f.input_radio(
      lang('access_rules.labels.rule_applies'), 
      :rule_applies, 
      rule_applies,
      :values => @rule_applies_hash
    )
    
    f.g.div(:id => 'div_user_id') do
      f.select(
        lang('access_rules.labels.user'), 
        :user_id, 
        :values   => users,
        :selected => @access_rule.user_id, 
        :size     => 1
      ) 
    end
    
    f.g.div(:id => 'div_user_group_id') do
      f.select(
        lang('access_rules.labels.user_group'), 
        :user_group_id, 
        :values   => groups,
        :selected => @access_rule.user_group_id, 
        :size     => 1
      )
    end
      
    f.select(
      lang('access_rules.labels.extension'), 
      :extension, 
      :values   => packages,
      :selected => @access_rule.extension, 
      :size     => 1
    )

    f.input_radio(
      lang('access_rules.labels.create'), 
      :create_access, 
      @access_rule.create_access,
      :values => @boolean_hash
    )
  
    f.input_radio(
      lang('access_rules.labels.read'), 
      :read_access, 
      @access_rule.read_access,
      :values => @boolean_hash
    )
  
    f.input_radio(
      lang('access_rules.labels.update'), 
      :update_access, 
      @access_rule.update_access,
      :values => @boolean_hash
    )

    f.input_radio(
      lang('access_rules.labels.delete'), 
      :delete_access, 
      @access_rule.delete_access,
      :values => @boolean_hash
    )
    
    f.g.div(:class => 'clearfix') do
      f.g.div(:class => 'button') do
        f.g.input(:type => 'submit', :value => lang('access_rules.buttons.save'))
      end
    end

  end
}
